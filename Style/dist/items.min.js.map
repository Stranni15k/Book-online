{"version":3,"sources":["items.js"],"names":["imagefilms","filmid","Handlebars","registerHelper","value","options","parseInt","fetch","Map","ItemLine","imgsource","price","title","name","description","_classCallCheck","this","items","item","console","info","then","response","text","json","table","innerHTML","template","Object","fromEntries","clear","i","data","length","current","error","set","createFrom","loadItemsTable","html","compile","entries","drawItemsTable","document","querySelector","id","log","removeItemFromTable","method","has","headers","userid","addtoitem","content","regeneratorRuntime","async","_context2","prev","next","awrap","sent","getElementById","style","visibility","stop","GetDescription","desc","select","drawItemsSelect","file","input","files","reader","FileReader","onload","result","butt","onclick","imglem","pricelem","authorlem","namelem","descriptionlem","currentname","JSON","body","stringify","edititem","_current","_currentname","_context","Content-type","loadItemsSelect"],"mappings":"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","file":"items.min.js","sourcesContent":["'use strict'\r\n\r\nvar imagefilms;\r\nvar filmid = 10;\r\n\r\nHandlebars.registerHelper(\"inc\", function (value, options) {\r\n    return parseInt(value) + 1;\r\n});\r\n\r\nconst items = new Map();\r\n\r\nclass ItemLine {\r\n    constructor(imgsource, price, title, name,description) {\r\n        this.imgsource = imgsource;\r\n        this.price = parseInt(price);\r\n        this.title = title;\r\n        this.name = name;\r\n        this.description = description;\r\n    }\r\n\r\n    static createFrom(item) {\r\n        return new ItemLine(item.imgsource, item.price, item.title, item.name, item.description);\r\n    }\r\n};\r\n\r\nfunction loadItemsTable() {\r\n    console.info('Try to load data');\r\n\r\n    function drawItemsTable() {\r\n        console.info('Try to draw table');\r\n\r\n        const table = document.querySelector(\".books #out\");\r\n        if (table == null) {\r\n            throw 'Table is not found';\r\n        }\r\n\r\n        fetch(\"handlebars/items-table.html\")\r\n            .then(function (response) {\r\n                return response.text();\r\n            })\r\n            .then(function (html) {\r\n                const template = Handlebars.compile(html);\r\n                table.innerHTML = template({ 'items': Object.fromEntries(items.entries()) });\r\n                console.info('Drawn');\r\n            })\r\n            .catch(function (error) {\r\n                console.error('Error:', error);\r\n                throw \"Can't render template\";\r\n            });\r\n    }\r\n\r\n    fetch(\"http://localhost:8079/lines\")\r\n        .then(function (response) {\r\n            return response.json();\r\n        })\r\n        .then(function (data) {\r\n            console.info('Loaded');\r\n            items.clear();\r\n            for (let i = 0; i < data.length; i++) {\r\n                const current = data[i];\r\n                items.set(current.id, ItemLine.createFrom(current));\r\n            }\r\n            drawItemsTable();\r\n        })\r\n        .catch(function (error) {\r\n            console.error('Error:', error);\r\n            throw \"Can't load items\";\r\n        });\r\n}\r\n\r\nbutt.onclick = function() {\r\n\r\n    var imglem = document.getElementById('urltoimage').innerHTML = imagefilms;\r\n    var namelem = document.getElementById('namelem').value;\r\n    var pricelem = document.getElementById('pricelem').value;\r\n    var authorlem = document.getElementById('authorlem').value;\r\n    var descriptionlem = document.getElementById('descriptionlem').value;\r\n    \r\n    filmid = filmid + 1;\r\n\r\n    const current = {imgsource: imglem, price: pricelem, title: namelem, name: authorlem, description: descriptionlem};\r\n    const currentname = {name: namelem, id: userid};\r\n\r\n    fetch(\"http://localhost:8079/lines\", \r\n    { \r\n        method: 'POST', \r\n        body: JSON.stringify(current),\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json'\r\n        }\r\n    })\r\n    .then(function (response) {\r\n        return response.json();\r\n    })\r\n    .then(function (data) {\r\n        console.info('Added');\r\n        console.log(data);\r\n        \r\n        loadItemsTable();\r\n    })\r\n    .catch(function (error) {\r\n        console.error('Error:', error);\r\n        throw \"Can't add item\";\r\n    });\r\n\r\n    fetch(\"http://localhost:8079/items/\", \r\n    { \r\n        method: 'POST',\r\n        body: JSON.stringify(currentname),\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json'\r\n        }\r\n    })\r\n    .then(function (response) {\r\n        return response.json();\r\n    })\r\n    .then(function (data) {\r\n        console.info('Added');\r\n        console.log(data);\r\n    })\r\n    .catch(function (error) {\r\n        console.error('Error:', error);\r\n        throw \"Can't add item\";\r\n    });\r\n};\r\n\r\nfunction removeItemFromTable(id) {\r\n    console.info('Try to remove item');\r\n\r\n    if (!confirm('Do you really want to remove this item?')) {\r\n        console.info('Canceled');\r\n        return;\r\n    }\r\n\r\n    if (!items.has(id)) {\r\n        throw 'Item with id [' + id + '] is not found';\r\n    }\r\n\r\n    fetch(\"http://localhost:8079/lines/\" + id,\r\n        {\r\n            method: 'DELETE'\r\n        })\r\n        .then(function () {\r\n            console.info('Removed');\r\n            loadItemsTable();\r\n        })\r\n        .catch(function (error) {\r\n            console.error('Error:', error);\r\n            throw \"Can't add item\";\r\n        });\r\n    \r\n    fetch(\"http://localhost:8079/items/\" + id,\r\n        {\r\n            method: 'DELETE'\r\n        })\r\n        .then(function () {\r\n            console.info('Removed');\r\n            loadItemsTable();\r\n        })\r\n        .catch(function (error) {\r\n            console.error('Error:', error);\r\n            throw \"Can't add item\";\r\n        });\r\n    \r\n}\r\n\r\nedititem.onclick = async function() {\r\n\r\n    let response = await fetch(\"http://localhost:8079/lines/\" + userid);\r\n    let content = await response.json();\r\n\r\n    if(imagefilms == null) {\r\n        var imglem = document.getElementById('urltoimage').innerHTML = content.imgsource;\r\n        var namelem = document.getElementById('namelem').value;\r\n        var pricelem = document.getElementById('pricelem').value;\r\n        var authorlem = document.getElementById('authorlem').value;\r\n        var descriptionlem = document.getElementById('descriptionlem').value;\r\n    \r\n        const current = {imgsource: imglem, price: pricelem, title: namelem, name: authorlem,description: descriptionlem};\r\n        const currentname = {name: namelem, id: filmid};\r\n    \r\n        fetch(\"http://localhost:8079/lines/\" + userid,\r\n        {\r\n            method: 'PUT',\r\n            headers: {\r\n                'Content-type': \"application/json\",\r\n            },\r\n            body: JSON.stringify(current),\r\n        });\r\n    \r\n        fetch(\"http://localhost:8079/items/\" + userid, \r\n        { \r\n            method: 'PUT',\r\n            headers: {\r\n                'Content-type': \"application/json\",\r\n            },\r\n            body: JSON.stringify(currentname),\r\n        });\r\n    \r\n        loadItemsTable();\r\n    }\r\n    else\r\n\r\n    var imglem = document.getElementById('urltoimage').innerHTML = imagefilms;\r\n    var namelem = document.getElementById('namelem').value;\r\n    var pricelem = document.getElementById('pricelem').value;\r\n    var authorlem = document.getElementById('authorlem').value;\r\n    var descriptionlem = document.getElementById('descriptionlem').value;\r\n\r\n    const current = {imgsource: imglem, price: pricelem, title: namelem, name: authorlem,description: descriptionlem};\r\n    const currentname = {name: namelem, id: filmid};\r\n\r\n    fetch(\"http://localhost:8079/lines/\" + userid,\r\n    {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Content-type': \"application/json\",\r\n        },\r\n        body: JSON.stringify(current),\r\n    });\r\n\r\n    fetch(\"http://localhost:8079/items/\" + userid, \r\n    { \r\n        method: 'PUT',\r\n        headers: {\r\n            'Content-type': \"application/json\",\r\n        },\r\n        body: JSON.stringify(currentname),\r\n    });\r\n\r\n    loadItemsTable();\r\n}\r\n\r\nvar userid;\r\n\r\nfunction editItemFromTable(id) {\r\n    userid = id;\r\n    console.log(userid);\r\n}\r\n\r\nmodalokno.onclick = function() {\r\n    document.getElementById(\"butt\").style.visibility = \"visible\";\r\n    document.getElementById(\"edititem\").style.visibility = \"hidden\"\r\n\r\n}\r\n\r\nasync function addtoitem() {\r\n    let response = await fetch(\"http://localhost:8079/lines/\" + userid);\r\n    let content = await response.json();\r\n\r\n    document.getElementById(\"urltoimage\").innerHTML = content.imgsource;\r\n    document.getElementById(\"namelem\").value = content.title;\r\n    document.getElementById(\"pricelem\").value = content.price;\r\n    document.getElementById(\"authorlem\").value = content.name;\r\n    document.getElementById(\"descriptionlem\").value = content.description;\r\n\r\n    document.getElementById(\"edititem\").style.visibility = \"visible\";\r\n    document.getElementById(\"butt\").style.visibility = \"hidden\"\r\n}\r\n\r\nasync function GetDescription() {\r\n    \r\n    let response = await fetch(\"http://localhost:8079/lines/\" + userid);\r\n    let content = await response.json();\r\n\r\n    function drawItemsTable() {\r\n        console.info('Try to draw table');\r\n\r\n        const desc = document.querySelector(\"#exampleModal1 .modal-dialog .modal-content .modal-header #exampleModal1Label\");\r\n        const table = document.querySelector(\"#exampleModal1 .modal-dialog .modal-content .modal-body #infodesc\");\r\n\r\n        desc.innerHTML = content.title;\r\n        table.innerHTML = content.description;\r\n    }\r\n\r\n    drawItemsTable();\r\n\r\n}\r\n\r\nfunction loadItemsSelect(select) {\r\n    function drawItemsSelect(select, data) {\r\n        fetch(\"handlebars/items-select.html\")\r\n            .then(function (response) {\r\n                return response.text();\r\n            })\r\n            .then(function (html) {\r\n                const template = Handlebars.compile(html);\r\n                select.innerHTML += template({ 'items': data });\r\n            })\r\n            .catch(function (error) {\r\n                console.log('Error:', error);\r\n                throw \"Can't load items\";\r\n            });\r\n    }\r\n\r\n    fetch(\"http://localhost:8079/items\")\r\n        .then(function (response) {\r\n            return response.json();\r\n        })\r\n        .then(function (data) {\r\n            drawItemsSelect(select, data);\r\n        })\r\n        .catch(function (error) {\r\n            console.log('Error:', error);\r\n            throw \"Can't load items\";\r\n        });\r\n}\r\n\r\nfunction donwload(input) {\r\n    let file = input.files[0];\r\n    let reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n\r\n    reader.onload = function () {\r\n        imagefilms = reader.result;\r\n    }\r\n}\r\n\r\nloadItemsSelect(item);\r\nloadItemsTable();"]}